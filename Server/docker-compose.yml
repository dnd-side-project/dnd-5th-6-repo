version: '3'
services:
    app:
      image: node:12-alpine
      build:
        context: .
        dockerfile: Dockerfile
      ports:
        - 3000:3000
      working_dir: /app
      command: sh -c "npm install && npx prisma generate && npm run serve:start"
    prisma:
      image: prismagraphql/prisma:1.34
      restart: always
      ports:
        - '4466:4466'
      environment:
        PRISMA_CONFIG: |
          managementApiSecret: dnd5_6
          port: 4466
          databases:
            default:
              connector: mysql
              host: dnd-instance.ckymmd75tic1.ap-northeast-2.rds.amazonaws.com
              port: 3306
              user: admin
              password: dnd565656
              connectionLimit: 2
